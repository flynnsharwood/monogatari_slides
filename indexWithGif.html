<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=2151, height=900">
        <title>Nox colored frame Generator</title>
        <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+Display:wght@400;700&family=Charm:wght@400;700&display=swap" rel="stylesheet">
        <style>
            body { font-family: 'Georgia', serif; text-align: center; background: black; color: white; }
            textarea { width: 80%; height: 150px; margin-bottom: 10px; }
            .frame-container { position: relative; width: 2151px; height: 900px; display: flex; align-items: center; justify-content: center; }
            .frame {
                width: 2151px; height: 900px;
                display: flex; align-items: center; justify-content: center;
                flex-direction: column; font-size: 3vw;
                position: absolute;
            }
            .frame-number { font-family: 'Charm', cursive; font-size: 1.4vw; margin-top: 10px; position: relative; }
            .frame-color { font-family: 'Charm', cursive; font-size: 1.2vw; margin-top: 10px; position: relative; }
            .main-text { font-family: 'Noto Serif Display', serif; font-size: 4vw; }
            .animated-text { position: relative; }
            .footer { font-family: 'Charm', cursive; font-size: 1.6vw; position: absolute; bottom: 20px; }
        </style>
    </head>
<body>
    <h2>Nox colored frame Generator</h2>
    <textarea id="cssList" placeholder="Example:\nPurple. ToTT kyu?\nBlue* Moving Text"></textarea><br>
    <input type="text" id="footerText" placeholder="Footer text"><br>
    <input type="number" id="startFrameNumber" placeholder="Start frame from" min="1" style="width: 150px;"> <br>
    <button onclick="generateFrames()">Generate Frames</button>
    <div class="frame-container" id="frameContainer"></div>
    <script>
        const colorMap = {
            black: "#302e3b",
            purple: "#582158",
            brown: "rgb(65, 52, 36)",
            red: "#ba1113",
            reddark: "#a81518",
            blue: "#62608f",
            yellow: "#cb7b1e"
        };

        function generateFrames() {
    const inputText = document.getElementById("cssList").value.trim();
    const footerText = document.getElementById("footerText").value.trim();
    const startFrameNumber = parseInt(document.getElementById("startFrameNumber").value) || 1;
    const lines = inputText.split("\n");
    const container = document.getElementById("frameContainer");
    container.innerHTML = "";
    
    lines.forEach((line, index) => {
        const match = line.trim().match(/([a-zA-Z]+)[.*]?\s*(.*)?/);
        if (!match) return;

        const colorKey = match[1].toLowerCase();
        let text = match[2] ? match[2].trim() : "";
        const frameNumber = startFrameNumber + index;
        const isAnimated = line.includes("*");

        // Omit main text if only "color."
        if (text == "") text = "";

        if (isAnimated) {
            exportAnimatedFrames(text, colorKey, frameNumber, footerText);
        } else {
            exportStaticFrame(text, colorKey, frameNumber, footerText);
        }
    });
}


        function exportStaticFrame(text, colorKey, frameNumber, footerText) {
            const frame = document.createElement("div");
            frame.classList.add("frame");
            frame.style.backgroundColor = colorMap[colorKey] || colorKey;
            frame.innerHTML = `<div class='main-text'>${text}</div>
                               <div class='frame-color'>${colorKey.charAt(0).toUpperCase() + colorKey.slice(1)}</div>
                               <div class='frame-number'>frame ${frameNumber}</div>
                               <div class='footer'>${footerText}</div>`;
            document.body.appendChild(frame);
            
            html2canvas(frame).then(canvas => {
                const link = document.createElement("a");
                link.download = `frame_${frameNumber}.png`;
                link.href = canvas.toDataURL();
                link.click();
                document.body.removeChild(frame);
            });
        }

        function exportAnimatedFrames(text, colorKey, frameNumber, footerText) {
    const positions = [
        [0, 0], [0,3], [0, 7], [3, 7], [7, 7], [4, 7], [0, 7], [0, 4] [0, 0]
    ];
    const totalFrames = 24;  // 24 FPS * 2 seconds
    let frameIndex = 0;
    const zip = new JSZip();

    function captureFrame() {
        if (frameIndex >= totalFrames) {
            zip.generateAsync({ type: "blob" }).then(function(content) {
                const link = document.createElement("a");
                link.href = URL.createObjectURL(content);
                link.download = `frames_${frameNumber}.zip`;
                link.click();
            });
            return;
        }

        let pos = positions[frameIndex % positions.length];
        const frame = document.createElement("div");
        frame.classList.add("frame");
        frame.style.backgroundColor = colorMap[colorKey] || colorKey;
        frame.innerHTML = `<div class='main-text' style='transform: translate(${pos[0]}px, ${pos[1]}px)'>${text}</div>
                           <div class='frame-color' style='transform: translate(${pos[0]}px, ${pos[1]}px)'>${colorKey.charAt(0).toUpperCase() + colorKey.slice(1)}</div>
                           <div class='frame-number' style='transform: translate(${pos[0]}px, ${pos[1]}px)'>Frame ${frameNumber}</div>
                           <div class='footer'>${footerText}</div>`;
        document.body.appendChild(frame);

        html2canvas(frame).then(canvas => {
            canvas.toBlob(blob => {
                zip.file(`frame_${frameIndex + 1}.png`, blob);
                document.body.removeChild(frame);
                frameIndex++;
                captureFrame();
            });
        });
    }
    captureFrame();
}

    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
</body>
</html>